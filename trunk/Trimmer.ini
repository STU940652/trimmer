#Trimmer Ini File
#
# This can be in the AppsData directory, or the ProgramFiles directory.  Anything in AppsData overrides ProgramFiles
#
# The FilePaths Section is normally only in AppsData
#[FilePaths]
#FileCopy = False
#SourcePath = D:\PRIVATE\AVCHD\BDMV\STREAM
#DestPath = C:\Documents and Settings\AndynDeanna\My Documents\Sandbox
#AutoStart = True
[Upload]
MP3BasePath = sermons\%%Y

[Segment1]
Name = Site Video: No Prayer (With Upload)
EncodeString = ffmpeg -report -nostdin -i "$InFile$"
 -vf "fade=in:st=$FadeInStart$:d=$FadeLength$,fade=out:st=$FadeOutStart$:d=$FadeLength$,format=pix_fmts=yuv420p"
 -vcodec libx264 -profile:v baseline -x264opts keyint=123:min-keyint=25:crf=19 -vsync cfr
 -af "dynaudnorm=b=1:m=100.0,afade=in:st=$FadeInStart$:d=$FadeLength$,afade=out:st=$FadeOutStart$:d=$FadeLength$"
 -acodec libvo_aacenc -ac 2 -ab 320k -profile:a aac_low
 -ss $OutputStart$ -t $OutputLength$ "$OutFileName$.mp4"
DefaultOutFileName = $DateSunday$_without_prayer
Completion = {"Site-MP4": "$OutFileName$.mp4"}

[Segment2]
Name = Public Video: With Prayer (With Upload)
EncodeString = ffmpeg -report -nostdin  -i "$InFile$"
 -vf "fade=in:st=$FadeInStart$:d=$FadeLength$,fade=out:st=$FadeOutStart$:d=$FadeLength$,format=pix_fmts=yuv420p"
 -vcodec libx264 -profile:v high -x264opts keyint=123:min-keyint=25:crf=21 -vsync cfr
 -af "dynaudnorm=b=1:m=100.0,afade=in:st=$FadeInStart$:d=$FadeLength$,afade=out:st=$FadeOutStart$:d=$FadeLength$"
 -acodec libvo_aacenc -ac 2 -ar 48000 -ab 320k -profile:a aac_low
 -metadata title="$Title$"
 -metadata album="$Series$"
 -metadata artist="$Speaker$"
 -metadata comment="$Date$ $Comment$"
 -ss $FadeInStart$ -t $OutputLengthNoHT$ "$OutFileName$-$SpeakerLast$.mp4"
 -ss $FadeInStart$ -t $OutputLengthNoHT$ -map_channel 0.1.0 "$OutFileName$-$SpeakerLast$.wav" 
 -af "dynaudnorm=b=1:m=100.0,aresample=22050,aformat=channel_layouts=mono" 
 -metadata title="$Title$"
 -metadata album="$Series$"
 -metadata artist="$Speaker$"
 -metadata date="$Date$"
 -metadata comment="$Comment$"
 -id3v2_version 3
 -write_id3v1 1
 -acodec libmp3lame -ab 32k -ss $FadeInStart$ -t $OutputLengthNoHT$ "$OutFileName$-$SpeakerLast$.mp3"
DefaultOutFileName = $DateSunday$sermon
Completion = {"MP3":"$OutFileName$-$SpeakerLast$.mp3", "MP4": "$OutFileName$-$SpeakerLast$.mp4"}

[Segment3]
Name = Custom (No Upload)
EncodeString = ffmpeg -report -nostdin -i "$InFile$"
 -vf "fade=in:st=$FadeInStart$:d=$FadeLength$,fade=out:st=$FadeOutStart$:d=$FadeLength$,format=pix_fmts=yuv420p"
 -vcodec libx264 -profile:v baseline -x264opts keyint=123:min-keyint=25:crf=19 -vsync cfr
 -af "dynaudnorm=b=1:m=100.0,afade=in:st=$FadeInStart$:d=$FadeLength$,afade=out:st=$FadeOutStart$:d=$FadeLength$"
 -acodec libvo_aacenc -ac 2 -ab 320k -profile:a aac_low
 -ss $OutputStart$ -t $OutputLength$ "$OutFileName$.mp4"
DefaultOutFileName = $DateSunday$_custom
Completion = None

[Segment4]
Name = Site Video: With Preroll, No Prayer (With Upload)
AdditionalInputs = @Pre_Roll 
EncodeString = ffmpeg -report -nostdin 
 -i "$@Pre_Roll$"
 -ss $ClipStart$ -t $ClipLength$ 
 -i "$InFile$"
#-vf "fade=in:st=0:d=$FadeLength$,fade=out:st=$FadeOutStart$:d=$FadeLength$,format=pix_fmts=yuv420p"
 -filter_complex "color=c=black:s=hd1080:r=ntsc:d=5.0 [vblackin];aevalsrc=0:d=5 [ablackin];[0:v:0] scale=s=hd1080,setsar=0 [vbumpscale]; [1:v:0] fade=in:st=0.033:d=0.5,fade=out:st=$ClipFade$:d=0.5,format=pix_fmts=yuv420p,scale=s=hd1080 [vtrim];[1:a:0] dynaudnorm=b=1:m=100.0,afade=in:st=0:d=0.5,afade=out:st=$ClipFade$:d=0.5 [atrim];color=c=black:s=hd1080:r=ntsc:d=10.0 [vblackout];aevalsrc=0:d=10 [ablackout];[vblackin] [ablackin] [vbumpscale] [0:a:0] [vtrim] [atrim] [vblackout] [ablackout] concat=n=4:v=1:a=1 [v] [a]" 
 -map "[v]" -map "[a]" 
 -vcodec libx264 -profile:v baseline -x264opts keyint=123:min-keyint=25:crf=19 -vsync cfr
#-af "dynaudnorm=b=1:m=100.0,afade=in:st=0:d=$FadeLength$,afade=out:st=$FadeOutStart$:d=$FadeLength$"
 -acodec libvo_aacenc -ac 2 -ab 320k -profile:a aac_low
 "$OutFileName$.mp4"
DefaultOutFileName = $DateSunday$_without_prayer
Completion = {"Site-MP4": "$OutFileName$.mp4"}

[Segment5]
Name = Public Video: With Prayer (Replace Existing)
AdditionalInputs = Vimeo_Number
EncodeString = ffmpeg -report -nostdin  -i "$InFile$"
 -vf "fade=in:st=$FadeInStart$:d=$FadeLength$,fade=out:st=$FadeOutStart$:d=$FadeLength$,format=pix_fmts=yuv420p"
 -vcodec libx264 -profile:v high -x264opts keyint=123:min-keyint=25:crf=21 -vsync cfr
 -af "dynaudnorm=b=1:m=100.0,afade=in:st=$FadeInStart$:d=$FadeLength$,afade=out:st=$FadeOutStart$:d=$FadeLength$"
 -acodec libvo_aacenc -ac 2 -ar 48000 -ab 320k -profile:a aac_low
 -metadata title="$Title$"
 -metadata album="$Series$"
 -metadata artist="$Speaker$"
 -metadata comment="$Date$ $Comment$"
 -ss $FadeInStart$ -t $OutputLengthNoHT$ "$OutFileName$-$SpeakerLast$.mp4"
 -ss $FadeInStart$ -t $OutputLengthNoHT$ -map_channel 0.1.0 "$OutFileName$-$SpeakerLast$.wav" 
 -af "dynaudnorm=b=1:m=100.0,aresample=22050,aformat=channel_layouts=mono" 
 -metadata title="$Title$"
 -metadata album="$Series$"
 -metadata artist="$Speaker$"
 -metadata date="$Date$"
 -metadata comment="$Comment$"
 -id3v2_version 3
 -write_id3v1 1
 -acodec libmp3lame -ab 32k -ss $FadeInStart$ -t $OutputLengthNoHT$ "$OutFileName$-$SpeakerLast$.mp3"
DefaultOutFileName = $DateSunday$sermon
Completion = {"Replace-MP4": "$OutFileName$-$SpeakerLast$.mp4", "Vimeo_Number": "$Vimeo_Number$"}


####
#
# 00:00:18.552
# 00:00:31.921
#
#rem Fade times are relative to the trimmed clip
#
# color=c=black:s=hd1080:r=ntsc:d=5.0
#
#ffmpeg -report -nostdin -y ^
#    -t 10 ^
#    -i "Custom Sermon Bumper Video Sample-SD.mp4" ^
#    -ss 15.702 -t 22.202000000000005 ^
#    -i "C:\\Non_Backup\\20150830sermon-Sublett.mp4" ^
#    -loop 1 -t 5 -i "End.png" ^
#    -i "logo.png" ^
#    -filter_complex "[0:v:0] scale=s=hd1080,setsar=0 [vbumpscale];[1:v:0] [3:v:0] overlay=main_w-overlay_w-10:main_h-overlay_h-10 [vover];[vover] fade=in:st=0:d=0.5,fade=out:st=21.702:d=0.5,format=pix_fmts=yuv420p,scale=s=hd1080 [vtrim];[1:a:0] afade=in:st=0:d=0.5,afade=out:st=21.702:d=0.5 [atrim];[2:v:0] scale=s=hd1080,setsar=0 [vend];aevalsrc=0:d=5 [aend];[vbumpscale] [0:a:0] [vtrim] [atrim] [vend] [aend] concat=n=3:v=1:a=1 [v] [a]" ^
#    -map "[v]" -map "[a]" ^
#    -vcodec libx264 -profile:v high -x264opts "keyint=123:min-keyint=25:crf=21" -vsync cfr ^
#    -acodec libvo_aacenc -ac 2 -ar 48000 -ab 320k -profile:a aac_low ^
#    -shortest ^
#    "bumper_test.mp4"
